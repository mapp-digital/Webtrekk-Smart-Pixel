(function(){var p={use:function(l){l.extension.push(function(g,l){function k(){if(b.Dressipi)try{b.Dressipi.apply(null,arguments)}catch(a){}}function q(a){return{sku:a.variant,productCode:a.fashionStyleId,name:a.fashionItemTitle,category:a.fashionItemCategory,quantity:a.quantity,price:a.cost,unitPrice:a.cost,currency:a.currency}}var f=!1,d={host:"",namespaceId:""},m=null,b=window,r=["view","addToCart","deleteFromCart","confirmation"],w={view:"pdp",addToCart:"addToBasket",deleteFromCart:"removeFromBasket",confirmation:"order"};
return{name:"fashion",version:"1.0.0",config:function(a){a&&"object"===typeof a&&("string"===typeof a.host&&(d.host=a.host),"string"===typeof a.namespaceId&&(d.namespaceId=a.namespaceId));return d},trigger:function(a){if(f&&("page"===a.mode||"action"===a.mode)&&"before"===a.type)if(a.data.fsn=1,m)m(a);else{"page"===a.mode&&k("track","pageView");a=g.customer.data.get();a={email:a.registrationEmail||null,customerId:a.id||null};var b=!(!a.email&&!a.customerId);b&&k("track","identify",a);for(var d=0;d<
r.length;d++){var h=r[d],c=g.product[h].data.get();if(0!==c.length){if("view"===h||"addToCart"===h||"deleteFromCart"===h)var e=q(c[0]);else{e=g.order.data.get();for(var t=[],n=0;n<c.length;n++)t.push(q(c[n]));c={};c.lineItems=c.items=t;c.orderId=e.id;c.total=e.value;c.shipping=e.shippingCosts;c.currency=e.currency;c.tax=e.tax;e=c}k("track",w[h],e,b?a:l)}}}},call:k,isActivated:function(){return f},activate:function(){if(!f&&(f=!0,!b.Dressipi&&(b.DressipiLoaderObjectName="Dressipi",b.Dressipi=b.Dressipi||
function(){(b.Dressipi.q=b.Dressipi.q||[]).push(arguments)},b.Dressipi.l=Date.now(),b.Dressipi("config","set","host",d.host),b.Dressipi("config","set","namespace_id",d.namespaceId),d.host&&d.namespaceId))){var a=g.init.get().trackDomain;g.utils.include("https://"+a+"/js/latest/smart-pixel-fashion-core.min.js")}},deactivate:function(){f&&(f=!1)},__upgrade:function(a){m=a}}})}},u="function"===typeof define&&define.amd,v="undefined"!==typeof module&&module.exports;u&&define("wtSmartFashion",p);
v&&(module.exports=p);u||v||(this.wtSmart=this.wtSmart||[],this.wtSmart.push(p.use));})();
